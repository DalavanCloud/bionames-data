{
   "_id": "_design/taxonName",
   "language": "javascript",
   "views": {
       "nameString": {
           "map": "/*\nIndex all likely ways of writing this name, \nincluding with and without subgenus. Goal is to\nmake it easy to find name. */\n\nfunction(doc) {\n  if (doc.type == 'nameCluster')\n  {\n  \t\n    // 1. emit name as is\n    emit(doc.nameComplete, doc._id);\n    \n    // 2. handle multiple ways we can write the \"same\" name\n    if (doc.uninomial) \n    {\n      // ignore \n    } \n    else \n    {\n      if (doc.rankString)\n      {\n        switch(doc.rankString)\n        {\n          // For subgenus we index the infragenericEpithet \n          // so we can find it if promoted to genus\n          case 'subgenus':\n            if (doc.infragenericEpithet)\n            {\n               emit(doc.infragenericEpithet, doc._id);\n            } \n            break;\n\n          // index species with and without subgenus\n          case 'species':\n            if (doc.infragenericEpithet)\n            {  \n               // genus + species\n               var str = doc.genusPart + ' ' + doc.specificEpithet;\n\n               if (str != doc.nameComplete)\n               {\n                 emit(str, doc._id);\n               }\n               // subgenus + species\n               str = doc.infragenericEpithet + ' ' + doc.specificEpithet;\n\n               if (str != doc.nameComplete)\n               {\n                 emit(str, doc._id);\n               }\n            }\n            break;\n\n          // index subspecies with and without species and without subgenus\n          case 'subspecies':\n            if (doc.infragenericEpithet)\n            {  \n               // genus + species + subspecies\n               emit(doc.genusPart + ' ' + doc.specificEpithet + ' ' + doc.infraspecificEpithet, doc._id);\n            }\n            // genus + subspecies\n            emit(doc.genusPart + ' ' + doc.infraspecificEpithet, doc._id);\n            break;\n \n          default:\n            break;\n         }\n      }\n    }\n  \n    /*\n    for (i in doc.names)\n    {\n  \n    // 1. emit name as is\n    emit(doc.names[i].nameComplete, doc._id);\n\n    // 2. handle multiple ways we can write the \"same\" name\n    if (doc.names[i].uninomial) \n    {\n      // ignore \n    } \n    else \n    {\n      if (doc.names[i].rankString)\n      {\n        switch(doc.names[i].rankString)\n        {\n          // For subgenus we index the infragenericEpithet \n          // so we can find it if promoted to genus\n          case 'subgenus':\n            if (doc.names[i].infragenericEpithet)\n            {\n               emit(doc.names[i].infragenericEpithet, doc._id);\n            } \n            break;\n\n          // index species with and without subgenus\n          case 'species':\n            if (doc.names[i].infragenericEpithet)\n            {  \n               // genus + species\n               var str = doc.names[i].genusPart + ' ' + doc.names[i].specificEpithet;\n\n               if (str != doc.names[i].nameComplete)\n               {\n                 emit(str, doc._id);\n               }\n               // subgenus + species\n               str = doc.names[i].infragenericEpithet + ' ' + doc.names[i].specificEpithet;\n\n               if (str != doc.names[i].nameComplete)\n               {\n                 emit(str, doc._id);\n               }\n            }\n            break;\n\n          // index subspecies with and without species and without subgenus\n          case 'subspecies':\n            if (doc.names[i].infragenericEpithet)\n            {  \n               // genus + species + subspecies\n               emit(doc.names[i].genusPart + ' ' + doc.names[i].specificEpithet + ' ' + doc.infraspecificEpithet, doc._id);\n            }\n            // genus + subspecies\n            emit(doc.names[i].genusPart + ' ' + doc.names[i].infraspecificEpithet, doc._id);\n            break;\n \n          default:\n            break;\n         }\n      }\n    }\n  }\n  */\n}\n}"
       },
       "name_id_to_cluster": {
           "map": "/*\nOutput ids of names in cluster\n*/\n\nfunction(doc) {\n  if (doc.type == 'nameCluster')\n  {\n    for (i in doc.names)\n    {\n      emit(doc.names[i].id, doc._id);\n    }\n  }\n}\n"
       }
   }
}